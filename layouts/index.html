{{ define "main" }}
<div class="homepage">
  <section class="homepage-hero">
    {{- $icon := resources.Get "images/icon.png" -}}
    {{- with $icon -}}
      <img class="homepage-hero-icon" src="{{ .RelPermalink }}" alt="{{ $.Site.Title }}" />
    {{- end -}}
    <h1>{{ .Site.Title }}</h1>
    {{- with .Site.Params.description | markdownify -}}
      <p class="homepage-hero-desc">{{ . }}</p>
    {{- end -}}
    {{- with .Content -}}{{ . }}{{- end -}}
  </section>

  {{- if isset .Site.Taxonomies "tags" -}}
    {{- if not (eq (len .Site.Taxonomies.tags) 0) -}}
      <section class="homepage-section">
        <details class="homepage-tag-cloud">
          <summary>Browse all {{ len .Site.Taxonomies.tags }} tags</summary>
          <div class="tag-cloud">
            {{ range .Site.Taxonomies.tags.Alphabetical -}}
              <a class="tag-pill" href="{{ .Page.RelPermalink }}">
                {{- .Page.LinkTitle | title -}}
                <span class="tag-count">{{ .Count }}</span>
              </a>
            {{ end }}
          </div>
        </details>
      </section>
    {{- end -}}
  {{- end -}}

  <section class="homepage-section">
    <h2>All Recipes</h2>
    <div class="recipe-grid">
      {{ range .Site.RegularPages.ByTitle }}
        <a class="recipe-card" href="{{ .Permalink }}">
          <h3>{{ .Title }}</h3>
          {{ $page := . -}}
          <div class="recipe-card-meta">
            {{- with .Params.prep_time -}}
              <span>üïê {{ . }} {{ $page.Params.prep_increment | default "min" }}</span>
            {{- end -}}
            {{- with $page.Params.servings -}}
              <span>üçΩÔ∏è {{ . }} servings</span>
            {{- end -}}
          </div>
          {{- with $page.Params.tags }}
            <div class="recipe-card-tags">
              {{ range . -}}
                <span class="recipe-card-tag">{{ . | title }}</span>
              {{ end -}}
            </div>
          {{- end }}
        </a>
      {{ end }}
    </div>
  </section>
</div>
{{ end }}
